
后台：
1, 本人交易记录，他人交易记录
2，总的在线情况，总的钻石变动情况
3，只有官方可分配权限


其它：
1, 玩家用微信发朋友圈推广次数统计，达到一定次数给用户钻石
2, 系统给每个新注册用户一定量的初始化: 


设计: 
1) 对于每一场牌局, 维护一个状态机器，并把状态机的状态更新到客户端, 每个状态附带的一些信息使用protobuf的optional一并更新过去
2) 把openid索引的client进redis 的 hashtable, 启动加载时可以记直接hgetall读到全部
3) 房间数据同上，放入redis的哈希表
4) 结算结果和扣钱一定要进mysql
5) gateway 做登录验证时，temp_token机制可以放到将来实现。 多个gateway可以共享一个redis, 再redis中存储


测试: 
A. 登录相关：
1) 同一openid多设备同时登录，能否正常挤掉人并继续游戏
2) 账号验证失败的处理
3) 服务器踢人

B. 存储和健壮性相关：
1) 宕机模拟
2) redis故障或意外重启模拟
3) mysql写入失败模拟




有时间重构:
1) 各路消息转发, 特别是端的消息转发, 远不够优雅, 效率也较低
2) 消息号的xml文件, 服务器本身不需要加载, 可以包含.h消息号定义文件直接解决




细节待补充:
1) 反外挂, 各种数据验证, 收到的枚举是否合法, 特别是建房间的数据
2) 各种配置



需要立刻补充:
 扣钱和充值, 非常重要
 数据持久化
 宕机恢复


很重要但可以稍后:
 玩家下线, 现在只有gateway知道, 别处都不知道, 要通知到其他进程

